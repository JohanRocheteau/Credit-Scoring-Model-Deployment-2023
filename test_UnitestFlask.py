import json
import pytest
import sys
import os
import numpy as np

# Ajoutez le chemin du rÃ©pertoire parent au chemin de recherche de Python
current_dir = os.path.dirname(os.path.abspath(__file__))
parent_dir = os.path.dirname(current_dir)
sys.path.append(parent_dir)

from AppFlask import app

@pytest.fixture
def client():
    app.config['TESTING'] = True
    with app.test_client() as client:
        yield client

data = [[1.0, 0.0, 0.0, 2.0, 315000.0, 1575000.0, 49018.5, 1575000.0, 0.026392, -13976.0, -1866.0, -2000.0, -4208.0, 1.0, 1.0, 0.0, 1.0, 1.0, 0.0, 4.0, 2.0, 2.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5096770801723647, 0.6127042441012546, 0.997, 0.375, 0.997, 0.375, 0.997, 0.375, 0.37, 0.0, 0.0, 0.0, 0.0, -1805.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.1335145964510589, 0.2, 78750.0, 0.1556142857142857, 0.0311228571428571, -2105.0, -269.0, -1401.75, 430355.8409090909, -1862.0, 30885.0, 2387.7, -651.5, 0.0, 0.0, 0.0, 393750.0, 126739.59, 1520875.08, 151015.5, 18630.45, 186304.5, 0.0, 14484.394285714285, 101390.76, 0.0, 560.0, 0.4166666666666667, 0.0, 0.5833333333333334, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5833333333333334, 0.4166666666666667, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1821.0, -269.0, -1050.4, -1105.0, 30885.0, 7872.75, -238.8, 0.0, 0.0, 393750.0, 172944.216, 864721.08, 151015.5, 46576.125, 186304.5, 0.0, 25347.69, 101390.76, 0.0, 175.0, -2105.0, -992.0, -1652.7142857142858, 224887.2380952381, -1862.0, -452.0, -1269.0, -946.2857142857144, 0.0, 0.0, 183600.0, 93736.28571428572, 656154.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 385.0, -20.0, -41.96774193548387, 31.0, 0.0, 0.0, 0.0, 0.0, 0.935483870967742, 0.0, 0.0, 0.0, 0.064516129032258, 0.0, 0.0, 0.0, 0.0, 0.0, 31.0, 6028.02, 11250.0, 8091.585, 0.0, 130765.5, 49207.5, 0.0, 225000.0, 92920.5, 0.0, 1.1081121947531565, 0.7770280486882891, 0.2709407607891121, 0.0, 11250.0, 3750.0, 49315.5, 130765.5, 82012.5, 9.0, 13.0, 10.8, 0.0, 0.1731243894402792, 0.0577081298134264, -1805.0, -531.0, -1124.2, 11.333333333333334, 34.0, 0.2, 0.6, 0.2, 0.0, 0.0, 0.0, 0.0, 0.2, 0.0, 0.8, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.8, 0.2, 0.0, 0.6, 0.2, 0.0, 0.2, 0.0, 0.6, 0.0, 0.0, 0.4, 0.0, 0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.8, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2, 0.0, 0.8, 0.2, 0.0, 0.8, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2, 0.0, 0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.4, 0.0, 0.2, 0.0, 0.0, 0.4, 0.4, 0.0, 0.8, 0.0, 0.2, 0.0, 0.0, 0.0, 0.0, 0.2, 0.6, 0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2, 0.0, 0.4, 0.0, 0.0, 0.0, 0.0, 0.0, 0.4, 0.0, 0.6, 0.0, 0.2, 0.0, 0.2, 0.0, 0.0, 0.2, 0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2, 0.2, 0.0, 0.0, 0.2, 0.0, 0.0, 0.0, 0.0, 6028.02, 11250.0, 8091.585, 0.0, 130765.5, 65574.0, 59521.5, 225000.0, 138429.0, 0.0, 1.1081121947531565, 0.7027040649177189, 0.3732668138025002, 0.0, 11250.0, 5625.0, 65956.5, 130765.5, 98361.0, 9.0, 13.0, 11.0, 0.0, 0.1731243894402792, 0.0865621947201396, -1805.0, -797.0, -1364.0, 11.333333333333334, 34.0, 3.0, 7.0, 0.2654867256637168, 30.0, 19.0, 3.265486725663717, 369.0, 1.0, 0.911504424778761, 103.0, 0.0453926840164854, 8505.0, 622.5507079646018, 70348.23, 2972475.6889432445, 38988.54, 4979.282256637169, 562658.895, 1.17, 38988.54, 4356.731548672567, 492310.665, -29.0, -858.5486725663717, -97016.0, 113.0]]
data2 = [[0.0, 0.0, 1.0, 1.0, 112500.0, 180000.0, 14220.0, 180000.0, 0.010556, -15974.0, -472.0, -5283.0, -5319.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0, 3.0, 3.0, 3.0, 14.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.377845152729456, 0.3706496323299817, np.nan, np.nan,np.nan,np.nan,np.nan,np.nan,np.nan, 2.0, 0.0, 2.0, 0.0, -2019.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0295480155252284, 0.625, 37500.0, 0.1264, 0.079, -866.0, -866.0, -866.0,np.nan, -777.0, -777.0, -777.0, -772.0, 0.0, 0.0, 0.0, 20080.62, 20080.62, 20080.62, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 29.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan, -866.0, -866.0, -866.0,np.nan, -777.0, -777.0, -777.0, -772.0, 0.0, 0.0, 20080.62, 20080.62, 20080.62, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 29.0, -20.0, -46.675, 40.0, 0.0, 0.0, 0.0, 0.0, 0.875, 0.0, 0.0, 0.0, 0.1, 0.0, 0.0, 0.025, 0.0, 0.0, 40.0, 4111.38, 19978.29, 7801.668, 0.0, 477000.0, 94874.14285714286, 0.0, 552555.0, 104581.92857142857, 0.863262480658034, 2.0, 1.1670976091316572, 0.2233616879385599, 0.0, 14940.0, 5647.5, 21780.0, 477000.0, 132823.8, 9.0, 20.0, 13.142857142857142, 0.0, 0.5445454545454544, 0.1881135638744912, -2246.0, -192.0, -978.0, 18.8, 94.0, 0.4285714285714285, 0.5714285714285714, 0.0, 0.0, 0.0, 0.2857142857142857, 0.0, 0.2857142857142857, 0.1428571428571428, 0.0, 0.0, 0.2857142857142857, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5714285714285714, 0.4285714285714285, 0.0, 0.5714285714285714, 0.2857142857142857, 0.1428571428571428, 0.0, 0.0, 0.7142857142857143, 0.0, 0.0, 0.2857142857142857, 0.0, 0.0, 0.1428571428571428, 0.0, 0.0, 0.0, 0.0, 0.0, 0.8571428571428571, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1428571428571428, 0.4285714285714285, 0.4285714285714285, 0.1428571428571428, 0.0, 0.8571428571428571, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.4285714285714285, 0.0, 0.0, 0.1428571428571428, 0.0, 0.0, 0.0, 0.0, 0.4285714285714285, 0.0, 0.0, 0.0, 0.1428571428571428, 0.5714285714285714, 0.2857142857142857, 0.0, 0.8571428571428571, 0.0, 0.1428571428571428, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5714285714285714, 0.4285714285714285, 0.0, 0.0, 0.0, 0.0, 0.0, 0.4285714285714285, 0.0, 0.1428571428571428, 0.0, 0.0, 0.0, 0.0, 0.0, 0.4285714285714285, 0.0, 0.2857142857142857, 0.4285714285714285, 0.1428571428571428, 0.1428571428571428, 0.0, 0.0, 0.0, 0.0, 0.2857142857142857, 0.0, 0.0, 0.0, 0.0, 0.1428571428571428, 0.0, 0.0, 0.1428571428571428, 0.0, 0.0, 0.2857142857142857, 0.1428571428571428, 0.0, 0.0, 0.0, 4111.38, 6313.59, 4757.5125, 21780.0, 81558.0, 46779.75, 14940.0, 90778.5, 44879.625, 0.8984285926733753, 2.0, 1.2430563912500632, 0.2593506733786703, 0.0, 14940.0, 5647.5, 21780.0, 81558.0, 46779.75, 9.0, 20.0, 12.75, 0.0, 0.5445454545454544, 0.1881135638744912, -2246.0, -1024.0, -1567.25, 11.5, 46.0, 2.0, 5.0, 0.4615384615384615, 18.0, 165.0, 23.56410256410257, 919.0, 1.0, 0.8974358974358975, 35.0, 0.0930047308030936, 6282.18, 546.6380769230769, 21318.885, 2746768.951146862, 43721.28, 6078.568846153846, 237064.185, 31.41, 43721.28, 5531.930769230769, 215745.3, -613.0, -1460.5641025641023, -56962.0, 39.0]]
data3 = [[1.0, 0.0, 0.0, 0.0, 99000.0, 225000.0, 19242.0, 225000.0, 0.0072739999999999, -10507.0, -2780.0, -5072.0, -2729.0, 1.0, 1.0, 0.0, 1.0, 1.0, 0.0, 2.0, 2.0, 2.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.6009994171816399, 0.7610263695502636, 0.9762, 0.1667, 0.9762, 0.1667, 0.9762, 0.1667, 0.0547, 0.0, 0.0, 0.0, 0.0, -2297.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 2.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.2645855144189588, 0.44, 49500.0, 0.1943636363636363, 0.08552, -2694.0, -1869.0, -2211.75, 169610.25, -2327.0, -1504.0, -1846.25, -733.75, 0.0, 0.0, 1906.875, 157500.0, 106875.0, 427500.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 293.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan, -2694.0, -1869.0, -2211.75, 169610.25, -2327.0, -1504.0, -1846.25, -733.75, 0.0, 0.0, 157500.0, 106875.0, 427500.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 293.0, -32.0, -61.5, 18.0, 0.0, 0.0, 0.0, 0.0, 0.8333333333333334, 0.0, 0.0, 0.0, 0.1111111111111111, 0.0, 0.0, 0.0555555555555555, 0.0, 0.0, 18.0, 5923.71, 55380.6, 25669.755, 0.0, 1800000.0, 507588.75, 0.0, 2013840.0, 578409.75, 0.7188685009794583, 1.0192185080608434, 0.8773006035378051, 0.022757070741009, 5400.0, 5400.0, 5400.0, 50355.0, 1800000.0, 676785.0, 10.0, 14.0, 11.5, 0.1073084071688226, 0.1073084071688226, 0.1073084071688226, -2297.0, -485.0, -1084.75, 34.0, 102.0, 0.75, 0.25, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.25, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.25, 0.5, 0.0, 0.5, 0.25, 0.25, 0.0, 0.0, 0.75, 0.0, 0.0, 0.25, 0.0, 0.0, 0.0, 0.0, 0.25, 0.0, 0.0, 0.0, 0.75, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.5, 0.25, 0.25, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.25, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.75, 0.0, 0.0, 0.0, 0.5, 0.25, 0.25, 0.0, 0.5, 0.25, 0.25, 0.0, 0.0, 0.0, 0.0, 0.0, 0.25, 0.75, 0.0, 0.0, 0.0, 0.0, 0.0, 0.25, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.75, 0.0, 0.25, 0.5, 0.0, 0.25, 0.0, 0.0, 0.0, 0.0, 0.25, 0.0, 0.25, 0.0, 0.25, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.25, 0.0, 0.0, 0.0, 0.0, 5923.71, 15704.955, 10814.3325, 50355.0, 180000.0, 115177.5, 49405.5, 250393.5, 149899.5, 0.7188685009794583, 1.0192185080608434, 0.8690435045201508, 0.045105063376894, 5400.0, 5400.0, 5400.0, 50355.0, 180000.0, 115177.5, 12.0, 14.0, 13.0, 0.1073084071688226, 0.1073084071688226, 0.1073084071688226, -2297.0, -1072.0, -1684.5, 21.0, 42.0, 2.0, 10.0, 1.1176470588235294, 19.0, 37.0, 13.705882352941176, 233.0, 1.0, 0.8823529411764706, 15.0, 0.1094914726750156, 5904.63, 696.9070588235294, 11847.42, 3842093.0212345584, 253355.31, 21627.672352941176, 367670.43, 19.08, 253355.31, 20930.76529411765, 355823.01, -984.0, -1906.9411764705883, -32418.0, 17.0]]

def test_predict_endpoint1(client):
    response = client.post('/api/', json = data)
    assert response.status_code == 200

def test_predict_endpoint2(client):
    response = client.post('/api/', json = data2)
    assert response.status_code == 200
    
def test_predict_endpoint3(client):
    response = client.post('/api/', json = data3)
    assert response.status_code == 200

if __name__ == '__main__':
    pytest.main()
